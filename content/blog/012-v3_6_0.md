+++
date = "2021-03-05T11:01:06-05:00"
title = "Goa v3.6.0"
description = "Announcing Goa v3.6.0"
author = "Raphael Simon"
weight = 2
layout = "blog"

[menu.main]
name = "Goa v3.6.0"
parent = "blog"
+++
  
Go v3.6.0 is out! There were many bug fixes made in the past 6 months (since
3.5.0), see the complete list on
[GitHub](https://github.com/goadesign/goa/compare/v3.5.0...v3.6.0). v3.6.0 also
brings many new features and improvements.

## New Features

### Multi-Server Mounting

The newly generated `Use` function on the generated HTTP server structs makes it
possible to mount multiple servers at the same time on the same underlying
muxer ([PR 2974](https://github.com/goadesign/goa/pull/2974)). 

```go
// Doing
s := goahttp.Server{s1, s2, s3}
s.Use(httpmiddleware.RequestID())
s.Mount(mux)

// Instead of
s := goahttp.Server{s1, s2, s3}
s.Use(httpmiddleware.RequestID())

server1.Mount(mux, s1)
server2.Mount(mux, s2)
server3.Mount(mux, s3)
```

Contributor: [Ernesto Jiménez](https://github.com/ernesto-jimenez)

### Custom Go Package Path for User Types

The new `struct:pkg:path` [Meta](https://pkg.go.dev/goa.design/goa/v3@v3.6.0/dsl#Meta)
tag makes it possible to specify the Go package path for the service level Go
structs generated by user types
([PR 3011](https://github.com/goadesign/goa/pull/3011)). 

```go
package design

var MyType = Type("MyType", func() {
    Attribute("name")
    Meta("struct:pkg:path", "types") // generates gen/types/my_type.go
})
```

In particular this makes it possible to generate structs from multiple services
in the same package so that for example the same HTTP middleware may be applied
to multiple services:

```go
package design

var MyType = Type("MyType", func() {
    Attribute("name")
    Meta("struct:pkg:path", "types") // generates gen/types/my_type.go
})

var _ = Service("service1", func() {
    Method("method1", func() {
        Payload(MyType) // uses gen/types/my_type.go
    })
})

var _ = Service("service2", func() {
    Method("method2", func() {
        Payload(MyType) // uses gen/types/my_type.go
    })
})
```

Contributor: [Raphael Simon](https://github.com/raphael)

## Improvements

### Better Error Handling

The [ServiceError](https://pkg.go.dev/goa.design/goa/v3@v3.6.0/pkg#ServiceError)
struct now includes a `Field` field which can be used to specify or lookup the
field that caused a validation error
([PR 2902](https://github.com/goadesign/goa/pull/2902)).  
Contributor: [Lawrence Jones](https://github.com/lawrencejones)

The handling of gRPC server errors is also improved with new DSL that makes it
possible for designs to generate errors consistent with the errors automatically
generated by Goa ([PR 2952](https://github.com/goadesign/goa/pull/2952)).  
Contributor: [Nitin Mohan](https://github.com/nitinmohan87)

### Better OpenAPI Specification

The OpenAPI specification generated for
[Map](https://pkg.go.dev/goa.design/goa/v3@v3.6.0/dsl#MapOf) types now has more
specific descriptions for the key and element types 
([PR 2941](https://github.com/goadesign/goa/pull/2941)).  
Contributor: [Taichi Sasaki](https://github.com/tchssk)

### Miscellaneous

The HTTP response capture middleware now supports the Flusher and Pusher interfaces
([PR 2976](https://github.com/goadesign/goa/pull/2976)).  
Contributor: [Raphael Simon](https://github.com/raphael)

Goa now supports vendoring at the project level
([PR 2979](https://github.com/goadesign/goa/pull/2979)).  
Contributor: [Dave Greene](https://github.com/davepgreene)

The default
[Goa encoders](https://pkg.go.dev/goa.design/goa/v3@v3.6.0/http#ResponseEncoder)
now set the `Content-Type` header in HTTP responses
([PR 2982](https://github.com/goadesign/goa/pull/2982)).  
Contributor: [@antichris](https://github.com/antichris)

The generated response encoding code now supports wrapped errors
([PR 3005](https://github.com/goadesign/goa/pull/3005)).  
Contributor: [Raphael Simon](https://github.com/raphael)

## Plugins

The new [Types Plugin](https://github.com/goadesign/plugins/tree/v3/types) makes
it possible to generate Go structs for user types outside of service definitions
([PR 120](https://github.com/goadesign/plugins/pull/120)).  
Contributor: [Raphael Simon](https://github.com/raphael)

There were also many improvements made to the CORS plugin
([PR 111](https://github.com/goadesign/plugins/pull/111)).  
Contributor: [Ernesto Jiménez](https://github.com/ernesto-jimenez)

The Goakit plugin now generates better service names
([PR 117](https://github.com/goadesign/plugins/pull/117)).  
Contributor: [@antichris](https://github.com/antichris)

## Documentation

On top of the code improvements above, there is also new documentation
explaining
[how to implement a Goa service](https://goa.design/implement/implementing/)
without using `goa example` with translations into
[Japanese](https://goa.design/ja/implement/implementing/) and
[Italian](https://goa.design/it/implement/implementing/).  
Contributors: [Raphael Simon](https://github.com/raphael),
[Taichi Sasaki](https:/github.com/tchssk),
[@ikawaha](https://github.com/ikawaha) and
[Alessandro Sanino](https://github.com/saniales).

The [Files](https://pkg.go.dev/goa.design/goa/v3@v3.6.0/dsl#Files) DSL is now
better documented ([PR 2962](https://github.com/goadesign/goa/pull/2962)).  
Contributor: [@kmacmcfarlane](https://github.com/kmacmcfarlane)

## Sponsors

Also new is the ability to [sponsor](https://www.patreon.com/goadesign) the Goa
project! he funds collected through this sponsorship help run the backend
infrastructure needed to support the website and the Go package repositories
hosted at https://goa.design. Any surplus goes towards efforts to build the
community.

## Going Forward

Thank you to all the contributors and users who helped improve Goa in the past 6
months. As you can see there were many improvements and I can't wait to see what
the next 6 months will bring!